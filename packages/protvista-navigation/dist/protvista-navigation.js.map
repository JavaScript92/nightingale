{"version":3,"file":"protvista-navigation.js","sources":["../src/protvista-navigation.js","../src/index.js"],"sourcesContent":["import * as d3 from \"d3\";\n\nconst height = 40,\n  width = 700,\n  padding = {\n    top: 10,\n    right: 10,\n    bottom: 10,\n    left: 10\n  };\n\nclass ProtVistaNavigation extends HTMLElement {\n\n  constructor() {\n    super();\n    this._length = parseInt(this.getAttribute('length'));\n    this._start = parseInt(this.getAttribute('start')) || 1;\n    this._end = parseInt(this.getAttribute('end')) || this._length;\n    this._highlightStart = parseInt(this.getAttribute('highlightStart'));\n    this._highlightEnd = parseInt(this.getAttribute('highlightEnd'));\n  }\n\n  connectedCallback() {\n    this._createNavRuler();\n  }\n\n  static get observedAttributes() {return [\n    'length', 'start', 'end', 'highlightStart', 'highlightEnd'\n  ]; }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue !== newValue){\n      this[`_${name}`] = parseInt(newValue);\n      this._updateLabels()\n      if (this._brushG) this._brushG\n        .call(this._viewport.move, [this._x(this._start), this._x(this._end)]);\n      this._updatePolygon();\n    }\n  }\n\n  _updateLabels() {\n    if (this._startLabel) this._startLabel.text(this._start);\n    if (this._endLabel) this._endLabel.text(this._end);\n  }\n\n  _createNavRuler() {\n    this._x = d3.scaleLinear().range([padding.left, width - padding.right]);\n    const x = this._x;\n    x.domain([1, (this._length + 1)]);\n\n    const svg = d3.select(this)\n      .append('div')\n      .attr('class', '')\n      .append('svg')\n      .attr('id', '')\n      .attr('width', width)\n      .attr('height', (height));\n\n    const xAxis = d3.axisBottom(x);\n\n    this._startLabel = svg.append(\"text\")\n                        .attr('class', 'start-label')\n                        .attr('x', 0)\n                        .attr('y', height - padding.bottom);\n\n    this._endLabel = svg.append(\"text\")\n                      .attr('class', 'end-label')\n                      .attr('x', width)\n                      .attr('y', height - padding.bottom)\n                      .attr('text-anchor', 'end');\n    svg.append('g')\n      .attr('class', 'x axis')\n      .call(xAxis);\n\n    this._viewport = d3.brushX().extent([\n        [padding.left, 0],\n        [(width - padding.right), height*0.51]\n      ])\n      .on(\"brush\", () => {\n        if (d3.event.selection){\n          this._start = d3.format(\"d\")(x.invert(d3.event.selection[0]));\n          this._end = d3.format(\"d\")(x.invert(d3.event.selection[1]));\n          this.dispatchEvent(new CustomEvent(\"change\", {\n            detail: {\n              value: this._start,\n              type: 'start'\n            }\n          }));\n          this.dispatchEvent(new CustomEvent(\"change\", {\n            detail: {\n              value: this._end,\n              type: 'end'\n            },\n          }));\n          this._updateLabels();\n        }\n      });\n\n    this._brushG = svg.append(\"g\")\n      .attr(\"class\", \"brush\")\n      .call(this._viewport);\n\n    this._brushG\n      .call(this._viewport.move, [x(this._start), x(this._end)]);\n\n    this.polygon = svg.append(\"polygon\")\n      .attr('class', 'zoom-polygon')\n      .attr('fill', '#777')\n      .attr('fill-opacity','0.3');\n    this._updatePolygon();\n  }\n  _updatePolygon(){\n    if (this.polygon) this.polygon\n      .attr('points',\n        `${this._x(this._start)},${height/2}\n        ${this._x(this._end)},${height/2}\n        ${width-padding.right},${height}\n        ${padding.left},${height}`\n      );\n  }\n}\n\nexport default ProtVistaNavigation;\n","import ProtVistaNavigation from './protvista-navigation';\n\nif (window.customElements) {\n  customElements.define('protvista-navigation', ProtVistaNavigation);\n}\n\nexport default ProtVistaNavigation;\n"],"names":["height","width","padding","ProtVistaNavigation","HTMLElement","_length","parseInt","getAttribute","_start","_end","_highlightStart","_highlightEnd","_createNavRuler","observedAttributes","name","oldValue","newValue","_updateLabels","_brushG","call","_viewport","move","_x","_updatePolygon","_startLabel","text","_endLabel","d3","range","left","right","x","domain","svg","append","attr","xAxis","bottom","extent","on","selection","invert","dispatchEvent","CustomEvent","polygon","window","customElements","define"],"mappings":"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"}