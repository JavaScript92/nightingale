{"version":3,"file":"protvista-zoomable.js","sources":["../src/protvista-zoomable.js","../src/main.js"],"sourcesContent":["import * as d3 from 'd3';\n\nclass ProtvistaZoomable extends HTMLElement {\n\n    constructor() {\n        super();\n        this._margin = {\n            top: 10,\n            right: 10,\n            bottom: 10,\n            left: 10\n        }\n        this.width = this.getAttribute('width') ? this.getAttribute('width') : this.offsetWidth;\n        this.length = this.getAttribute('length') ? parseInt(this.getAttribute('length')) : 0;\n\n        this.displayStart = this.getAttribute('displaystart')\n            ? parseInt(this.getAttribute('displaystart'))\n            : 0;\n        this.displayEnd = this.getAttribute('displayEnd')\n            ? parseInt(this.getAttribute('displayEnd'))\n            : this.width;\n\n        this.initZoom = this.initZoom.bind(this);\n        this.updateScaleDomain = this.updateScaleDomain.bind(this);\n        this.zoomed = this.zoomed.bind(this);\n        this.applyZoomTranslation = this.applyZoomTranslation.bind(this);\n    }\n\n    get displayStart() {\n        return this.getAttribute('displaystart');\n    }\n\n    set displayStart(displaystart) {\n        if (displaystart !== this.getAttribute('displaystart')) {\n            this.setAttribute('displaystart', displaystart);\n        }\n    }\n\n    get displayEnd() {\n        return this.getAttribute('displayend');\n    }\n\n    set displayEnd(displayend) {\n        if (displayend !== this.getAttribute('displayend')) {\n            this.setAttribute('displayend', displayend);\n        }\n    }\n\n    get width() {\n        return this._width;\n    }\n\n    set width(width) {\n        this._width = width;\n        this.initZoom();\n    }\n\n    set length(length) {\n        this._length = length;\n        this.updateScaleDomain();\n    }\n\n    get length() {\n        return this._length;\n    }\n\n    get xScale() {\n        return this._xScale\n    }\n\n    set xScale(xScale) {\n        this._xScale = xScale;\n        this._orignXScale = xScale;\n    }\n\n    get zoom() {\n        return this._zoom;\n    }\n\n    set svg(svg) {\n        this._svg = svg;\n        svg.call(this._zoom);\n    }\n\n    get svg() {\n        return this._svg;\n    }\n\n    updateScaleDomain() {\n        this.xScale = d3\n            .scaleLinear()\n            .domain([\n                1, this._length + 1\n            ])\n            .range([\n                this._margin.left, this._width - this._margin.right\n            ]);\n    }\n\n    initZoom() {\n        this._zoom = d3.zoom()\n            .scaleExtent([1, 40])\n            .translateExtent([\n                [\n                    0, 0\n                ],\n                [this.width, 100]\n            ])\n            .on(\"zoom\", this.zoomed.bind(this));\n    }\n\n    zoomed() {\n        this.xScale =\n            d3.event\n                .transform\n                .rescaleX(this._orignXScale);\n        this.refresh();\n    }\n\n    applyZoomTranslation() {\n        // TODO pass the SVG here or SVG should be on zoomable?\n        this._zoomScale = (this._length - this.displayEnd) / this.displayStart;\n        this\n            ._svg\n            .transition()\n            .duration(300)\n            .call(this._zoom.transform, d3.zoomIdentity.translate((-(this._xScale(this.displayStart) * this._zoomScale) + this._margin.left), 0).scale(this._zoomScale));\n        this.refresh();\n    }\n\n}\n\nexport default ProtvistaZoomable;","import ProtvistaZoomable from './protvista-zoomable';\n\nconst loadComponent = function() {\n    customElements.define('protvista-zoomable', ProtvistaZoomable);\n};\n\n// Conditional loading of polyfill\nif (window.customElements) {\n    loadComponent();\n} else {\n    document.addEventListener('WebComponentsReady', function() {\n        loadComponent();\n    });\n}\n\nexport default ProtvistaZoomable;"],"names":["ProtvistaZoomable","_margin","width","getAttribute","offsetWidth","length","parseInt","displayStart","displayEnd","initZoom","bind","updateScaleDomain","zoomed","applyZoomTranslation","xScale","d3","domain","_length","range","left","_width","right","_zoom","scaleExtent","translateExtent","on","transform","rescaleX","_orignXScale","refresh","_zoomScale","_svg","transition","duration","call","translate","_xScale","scale","displaystart","setAttribute","displayend","svg","HTMLElement","loadComponent","define","window","customElements","addEventListener"],"mappings":"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"}