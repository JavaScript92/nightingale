{"version":3,"file":"index.js","sources":["../src/InterproEntryLayout.js","../src/protvista-interpro-track.js","../src/index.js"],"sourcesContent":["import {DefaultLayout} from 'protvista-track';\r\n\r\nconst COLLAPSED_HEIGHT = 16;\r\nconst EXPANDED_HEIGHT = 14;\r\nconst CHILD_HEIGHT = 10;\r\n\r\nexport default class InterproEntryLayout extends DefaultLayout{\r\n  init(features, children){\r\n    let yPos = 0;\r\n    this.height = {}\r\n    this.yPos = {}\r\n    this.maxYPos = 0;\r\n    if (!features) return;\r\n    const residues_pos = {};\r\n    for (let k=0; k<features.length; k++) {\r\n      let feature = features[k];\r\n      this.height[feature.accession] = this.expanded ? EXPANDED_HEIGHT : COLLAPSED_HEIGHT;\r\n      this.yPos[feature.accession] = this._padding;\r\n      yPos = this.height[feature.accession] + 2*this._padding;\r\n      this.maxYPos = Math.max(this.maxYPos, yPos);\r\n      if (!(feature.accession in residues_pos))\r\n        residues_pos[feature.accession]={};\r\n      if (feature.residues)\r\n        yPos = this._initResidues(feature.residues, feature.accession, feature.locations, yPos, k, residues_pos);\r\n    }\r\n    if (children) for (let k=0; k<children.length; k++) {\r\n      const child = children[k];\r\n      // for (let child of children) {\r\n      if (!(child.accession in this.height)){\r\n        this.height[child.accession] = this.expanded ? CHILD_HEIGHT: 0;\r\n        this.yPos[child.accession] = this.maxYPos + this._padding;\r\n        yPos += 2*this._padding + this.height[child.accession];\r\n        this.maxYPos = Math.max(this.maxYPos, yPos);\r\n      }\r\n      if (!(child.accession in residues_pos))\r\n        residues_pos[child.accession]={};\r\n      if (child.residues)\r\n        yPos = this._initResidues(child.residues, child.accession, child.locations, yPos, k, residues_pos);\r\n    }\r\n    this.maxYPos += this._padding;\r\n  }\r\n\r\n  _initResidues(residues, feature_acc, locs, yPos, k, residues_pos ={}){\r\n    for (let i=0; i<residues.length; i++) {\r\n      const resGroup = residues[i];\r\n      this._filterOutResidueFragmentsOutOfLocation(resGroup, locs);\r\n      if (!(resGroup.accession in residues_pos[feature_acc]))\r\n        residues_pos[feature_acc][resGroup.accession]={};\r\n      for (let j=0; j<resGroup.locations.length; j++) {\r\n        const desc = resGroup.locations[j].description;\r\n        if (!(desc in residues_pos[feature_acc][resGroup.accession])) {\r\n          residues_pos[feature_acc][resGroup.accession][desc] = {\r\n            height: this.expanded ? CHILD_HEIGHT: 0,\r\n            yPos: this.maxYPos + this._padding\r\n          };\r\n          yPos = (this.expanded ? this.maxYPos +2*this._padding + CHILD_HEIGHT: yPos);\r\n        }\r\n        this.height[`${resGroup.accession}_${k}_${i}_${j}`] = residues_pos[feature_acc][resGroup.accession][desc].height;\r\n        this.yPos[`${resGroup.accession}_${k}_${i}_${j}`] = residues_pos[feature_acc][resGroup.accession][desc].yPos;\r\n        this.maxYPos = Math.max(this.maxYPos, yPos);\r\n      }\r\n    }\r\n    return yPos;\r\n  }\r\n  _filterOutResidueFragmentsOutOfLocation(residue, feature_locations){\r\n\r\n    residue.locations.forEach(\r\n      loc_res => loc_res.fragments = loc_res.fragments.filter(\r\n        frag_res => feature_locations.some(\r\n          loc => loc.fragments.some(\r\n            frag => frag_res.start >= frag.start && frag_res.end <= frag.end\r\n          )\r\n        )\r\n      )\r\n    )\r\n    residue.locations = residue.locations.filter(\r\n      loc_res => loc_res.fragments.length\r\n    );\r\n  }\r\n  _getAccFromFeature(feature){\r\n    let acc = '';\r\n    if (typeof feature === 'string') {\r\n      acc = feature;\r\n    } else if (feature.accession){\r\n        acc = feature.accession;\r\n    }\r\n    return acc;\r\n  }\r\n  getFeatureYPos(feature) {\r\n    const acc = this._getAccFromFeature(feature);\r\n    return acc in this.yPos ? this.yPos[acc] : 0;\r\n  }\r\n  getFeatureHeight(feature) {\r\n    const acc = this._getAccFromFeature(feature);\r\n    return acc in this.height ? this.height[acc] : 0;\r\n  };\r\n}\r\n","import ProtVistaTrack from \"protvista-track\";\r\nimport InterproEntryLayout from \"./InterproEntryLayout\";\r\n\r\nconst height = 44,\r\n  // width = 760,\r\n  padding = {\r\n    top: 2,\r\n    right: 10,\r\n    bottom: 2,\r\n    left: 10\r\n  };\r\n\r\nclass ProtVistaInterproTrack extends ProtVistaTrack {\r\n  _createTrack() {\r\n    this._layoutObj.expanded = this._expanded;\r\n    super._createTrack();\r\n    this.children_g = null;\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this._expanded = this.hasAttribute('expanded');\r\n    this._haveCreatedFeatures = false;\r\n  }\r\n\r\n  attributeChangedCallback(name, oldValue, newValue) {\r\n    if (name==='expanded' && oldValue !== newValue && this._contributors){\r\n      for (let c of this._contributors){\r\n        c.expanded = !oldValue;\r\n      }\r\n    }\r\n    super.attributeChangedCallback(name, oldValue, newValue);\r\n  }\r\n\r\n  set data(data) {\r\n    this._data = this.normalizeLocations(data);\r\n    this._createTrack();\r\n  }\r\n\r\n  set contributors(contributors) {\r\n    this._contributors = this.normalizeLocations(contributors);\r\n    if (this._data) this._createTrack();\r\n  }\r\n\r\n  getLayout(data) {\r\n      return new InterproEntryLayout({\r\n        layoutHeight:height,\r\n        expanded: this._expanded,\r\n        padding: 2,\r\n      });\r\n  }\r\n\r\n  static get observedAttributes() {\r\n    return ProtVistaTrack.observedAttributes.concat(['expanded','color']);\r\n  }\r\n  set color(value){\r\n    if (this._color !== value) {\r\n      this._color = value;\r\n      this.refresh();\r\n    }\r\n  }\r\n\r\n  _createResidueGroup(baseG){\r\n    return baseG.selectAll('g.residues-group')\r\n      .data(d => d.residues ? d.residues.map((r,i) => Object.assign({}, r, {feature: d, i:i})) : [])\r\n        .enter().append('g')\r\n          .attr('class', 'residues-group')\r\n          .selectAll('g.residues-locations')\r\n          .data(d =>\r\n            d.locations.map((loc, j) =>\r\n             Object.assign({}, loc, {\r\n               accession: d.accession,\r\n               feature: d.feature,\r\n               location: loc,\r\n               i: d.i,\r\n               j: j,\r\n               // expended: true\r\n             }))\r\n          )\r\n          .enter().append('g')\r\n            .attr('class', 'residues-locations');\r\n  }\r\n\r\n  _createResiduePaths(baseG){\r\n    return baseG\r\n      .selectAll('g.residue')\r\n      .data(d => d.fragments.map((loc) => Object.assign({}, loc, {accession: d.accession, feature: d.feature, location: d.location, k:d.feature.k, i: d.i, j:d.j})))\r\n      .enter()\r\n      .append('path')\r\n        .attr('class', 'feature')\r\n        .attr('d', (f,j) =>\r\n          this._featureShape.getFeatureShape(\r\n            this.xScale(2) - this.xScale(1), this._layoutObj.getFeatureHeight(`${f.accession}_${f.k}_${f.i}_${f.j}`),\r\n              f.end ? f.end - f.start + 1 : 1, 'rectangle'\r\n          )\r\n        )\r\n        .attr('transform',\r\n          f =>'translate(' + this.xScale(f.start)+ ',' + (padding.top + this._layoutObj.getFeatureYPos(`${f.accession}_${f.k}_${f.i}_${f.j}`)) + ')'\r\n        )\r\n        .attr('fill', f => this._getFeatureColor(f))\r\n        .attr('stroke', 'transparent');\r\n  }\r\n\r\n  _refreshResiduePaths(baseG){\r\n    baseG\r\n      .attr('d', f =>\r\n        this._featureShape.getFeatureShape(\r\n          this.xScale(2) - this.xScale(1), this._layoutObj.getFeatureHeight(`${f.accession}_${f.k}_${f.i}_${f.j}`),\r\n            f.end ? f.end - f.start + 1 : 1, 'rectangle'\r\n        )\r\n      )\r\n      .attr('transform',\r\n        f =>'translate(' + this.xScale(f.start)+ ',' + (padding.top + this._layoutObj.getFeatureYPos(`${f.accession}_${f.k}_${f.i}_${f.j}`)) + ')'\r\n      )\r\n      .attr('fill', f => this._getFeatureColor(f));\r\n  }\r\n\r\n  _addHoverEvents(features, type=\"entry\"){\r\n    features\r\n      .on('mouseover', (f, i, d) => {\r\n        this.dispatchEvent(new CustomEvent(\"change\", {\r\n          detail: {highlightend: f.end, highlightstart: f.start, type}, bubbles:true, cancelable: true\r\n        }));\r\n        this.dispatchEvent(new CustomEvent(\"entrymouseover\", {\r\n          detail: Object.assign(f, {target: d[i], type}), bubbles:true, cancelable: true\r\n        }));\r\n      })\r\n      .on('mouseout', (f, i, d) => {\r\n        this.dispatchEvent(new CustomEvent(\"change\", {\r\n          detail: {highlightend: null, highlightstart: null, type}, bubbles:true, cancelable: true\r\n        }));\r\n        this.dispatchEvent(new CustomEvent(\"entrymouseout\", {\r\n          detail: Object.assign(f, {type}), bubbles:true, cancelable: true\r\n        }));\r\n      })\r\n  }\r\n\r\n  _createFeatures(){\r\n    this._layoutObj.init(this._data, this._contributors);\r\n    this._data.forEach((d,i) => d.k = i);\r\n    this.featuresG = this.seq_g.selectAll('g.feature-group')\r\n      .data(this._data)\r\n      .enter()\r\n      .append('g')\r\n        .attr('class', 'feature-group')\r\n        .attr('id', d => `g_${d.accession}`);\r\n\r\n    this.locations = this.featuresG.selectAll('g.location-group')\r\n      .data(d => d.locations.map((loc) => Object.assign({}, loc, {feature: d})))\r\n        .enter().append('g')\r\n          .attr('class', 'location-group');\r\n\r\n    this.coverLines = this.locations\r\n      .selectAll('line.cover')\r\n      .data(d => [d.fragments.reduce(\r\n        (agg, v) => ({\r\n          start: Math.min(agg.start, v.start),\r\n          end: Math.max(agg.end, v.end),\r\n          feature: d.feature,\r\n        }) ,{start: Infinity, end: -Infinity})]\r\n      )\r\n      .enter()\r\n      .append('line')\r\n        .attr('class', 'cover');\r\n\r\n    this.features = this.locations\r\n      .selectAll('path.feature')\r\n      .data(d => d.fragments.map((loc) => Object.assign({}, loc, {feature: d.feature})))\r\n      .enter()\r\n      .append('path')\r\n        .attr('class', 'feature')\r\n        .on('click', (f, i, d) => {\r\n          if (this._expanded)\r\n            this.removeAttribute('expanded')\r\n          else\r\n            this.setAttribute('expanded', 'expanded')\r\n          this.dispatchEvent(new CustomEvent(\"entryclick\", {\r\n            detail: Object.assign(f, {target: d[i]}), bubbles:true, cancelable: true\r\n          }));\r\n        });\r\n\r\n    this._addHoverEvents(this.features);\r\n    this.residues_g = this._createResidueGroup(this.featuresG);\r\n    this.residues_loc = this._createResiduePaths(this.residues_g);\r\n    this._addHoverEvents(this.residues_loc, \"residue\");\r\n\r\n    if (this._contributors) {\r\n      this._contributors.forEach((d,i) => d.k = i);\r\n      if (!this.children_g)\r\n        this.children_g = this.svg.append('g')\r\n          .attr('class', 'children-features');\r\n\r\n      this.childrenGroup = this.children_g.append('g')\r\n        .attr('class', 'children-group')\r\n        .attr('visibility', this._expanded ? 'visible' : 'hidden' );\r\n      this.childGroup = this.childrenGroup.selectAll('g.child-group')\r\n        .data(d => this._contributors)\r\n        .enter()\r\n        .append('g')\r\n          .attr('class', 'child-group');\r\n      const locationChildrenG = this.childGroup.selectAll('g.child-location-group')\r\n        .data(d => {\r\n          d.expanded=this._expanded;\r\n          return d.locations.map((loc) => Object.assign({}, loc, {feature: d}))\r\n        })\r\n        .enter().append('g')\r\n          .attr('class', 'child-location-group');\r\n\r\n          this.coverLinesChildren = locationChildrenG\r\n            .selectAll('line.cover')\r\n            .data(d => [d.fragments.reduce(\r\n              (agg, v) => ({\r\n                start: Math.min(agg.start, v.start),\r\n                end: Math.max(agg.end, v.end),\r\n                feature: d.feature,\r\n              }) ,{start: Infinity, end: -Infinity})]\r\n            )\r\n            .enter()\r\n            .append('line')\r\n              .attr('class', 'cover');\r\n\r\n        this.featureChildren = locationChildrenG\r\n          .selectAll('path.child-fragment')\r\n          .data(d => d.fragments.map((fragment) => Object.assign({}, fragment, {feature: d.feature})))\r\n          .enter()\r\n          .append('path')\r\n            .attr('class', 'child-fragment')\r\n            .on('click', (f, i, d) => {\r\n              f.feature.expanded = !f.feature.expanded;\r\n              this.refresh();\r\n              this.dispatchEvent(new CustomEvent(\"entryclick\", {\r\n                detail: Object.assign(f, {target: d[i]}), bubbles:true, cancelable: true\r\n              }));\r\n            });\r\n        this._addHoverEvents(this.featureChildren);\r\n\r\n        this.child_residues_g = this._createResidueGroup(this.childGroup);\r\n        this.child_residues_loc = this._createResiduePaths(this.child_residues_g);\r\n        this._addHoverEvents(this.child_residues_loc, \"residue\");\r\n\r\n\r\n    }\r\n    this.svg.attr(\"height\", this._layoutObj.maxYPos);\r\n    this._haveCreatedFeatures = true;\r\n  }\r\n\r\n  _refreshFeatures(base) {\r\n    base\r\n      .attr('d', f =>\r\n        this._featureShape.getFeatureShape(\r\n          this.xScale(2) - this.xScale(1), this._layoutObj.getFeatureHeight(f.feature),\r\n            f.end ? f.end - f.start + 1: 1, this._getShape(f.shape ? f :f.feature)\r\n        )\r\n      )\r\n      .attr('fill', f => this._getFeatureColor(f.feature))\r\n      .attr('stroke', f => this._getFeatureColor(f.feature))\r\n      .attr('transform', f =>\r\n        'translate(' + this.xScale(f.start)+ ',' + (padding.top + this._layoutObj.getFeatureYPos(f.feature)) + ')'\r\n      );\r\n  }\r\n  _refreshCoverLine(base) {\r\n    base\r\n      .attr('x1', f => this.xScale(f.start))\r\n      .attr('x2', f => this.xScale(f.end + 1))\r\n      .attr('y1', f => padding.top + this._layoutObj.getFeatureYPos(f.feature) + this._layoutObj.getFeatureHeight(f.feature)/2)\r\n      .attr('y2', f => padding.top + this._layoutObj.getFeatureYPos(f.feature) + this._layoutObj.getFeatureHeight(f.feature)/2)\r\n      .attr('stroke', f => this._getFeatureColor(f.feature))\r\n  }\r\n\r\n  refresh(){\r\n    if (this._haveCreatedFeatures) {\r\n      this._layoutObj.expanded = this._expanded;\r\n      this._layoutObj.init(this._data, this._contributors);\r\n\r\n      this._refreshCoverLine(this.coverLines);\r\n      this._refreshFeatures(this.features);\r\n\r\n      this.residues_g.attr('visibility', this._expanded ? 'visible' : 'hidden' );\r\n      this._refreshResiduePaths(this.residues_loc);\r\n\r\n      if (this._contributors) {\r\n        this.childrenGroup.attr('visibility', this._expanded ? 'visible' : 'hidden' );\r\n        this._refreshCoverLine(this.coverLinesChildren);\r\n        this._refreshFeatures(this.featureChildren);\r\n        this.child_residues_g.attr('visibility', d => d.feature.expanded ? 'visible' : 'hidden');\r\n        this._refreshResiduePaths(this.child_residues_loc);\r\n\r\n      }\r\n      this._updateHighlight();\r\n      this.svg.attr(\"height\", this._layoutObj.maxYPos);\r\n      this.highlighted.attr('height', this._layoutObj.maxYPos);\r\n    }\r\n  }\r\n}\r\nexport default ProtVistaInterproTrack;\r\n","import ProtVistaInterproTrack from './protvista-interpro-track';\r\n\r\nconst loadComponent = function() {\r\n    customElements.define('protvista-interpro-track', ProtVistaInterproTrack);\r\n};\r\n\r\n// Conditional loading of polyfill\r\nif (window.customElements) {\r\n    loadComponent();\r\n} else {\r\n    document.addEventListener('WebComponentsReady', function() {\r\n        loadComponent();\r\n    });\r\n}\r\n\r\nexport default ProtVistaInterproTrack;\r\n"],"names":["COLLAPSED_HEIGHT","EXPANDED_HEIGHT","CHILD_HEIGHT","InterproEntryLayout","DefaultLayout","init","features","children","yPos","height","maxYPos","residues_pos","k","length","feature","accession","expanded","_padding","Math","max","residues","_initResidues","locations","child","feature_acc","locs","i","resGroup","_filterOutResidueFragmentsOutOfLocation","j","desc","description","residue","feature_locations","forEach","loc_res","fragments","filter","frag_res","some","loc","frag","start","end","_getAccFromFeature","acc","getFeatureYPos","getFeatureHeight","padding","top","right","bottom","left","ProtVistaInterproTrack","ProtVistaTrack","_createTrack","_layoutObj","_expanded","children_g","connectedCallback","hasAttribute","_haveCreatedFeatures","attributeChangedCallback","name","oldValue","newValue","_contributors","c","data","_data","normalizeLocations","contributors","getLayout","layoutHeight","observedAttributes","concat","color","value","_color","refresh","_createResidueGroup","baseG","selectAll","d","map","r","Object","assign","enter","append","attr","location","_createResiduePaths","f","_featureShape","getFeatureShape","xScale","_getFeatureColor","_refreshResiduePaths","_addHoverEvents","type","on","dispatchEvent","CustomEvent","detail","highlightend","highlightstart","bubbles","cancelable","target","_createFeatures","featuresG","seq_g","coverLines","reduce","agg","v","min","Infinity","removeAttribute","setAttribute","residues_g","residues_loc","svg","childrenGroup","childGroup","locationChildrenG","coverLinesChildren","featureChildren","fragment","child_residues_g","child_residues_loc","_refreshFeatures","base","_getShape","shape","_refreshCoverLine","_updateHighlight","highlighted","loadComponent","customElements","define","window","document","addEventListener"],"mappings":"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"}