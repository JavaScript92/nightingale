{"version":3,"file":"index.js","sources":["../src/protvista-manager.js","../src/index.js"],"sourcesContent":["class ProtVistaManager extends HTMLElement {\n\n  constructor() {\n    super();\n    this.protvistaElements = new Set();\n  }\n\n  static get observedAttributes() {\n    return ['attributes'];\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue !== newValue) {\n      if (name === \"attributes\") {\n        this._attributes = newValue.split(' ');\n        if (this._attributes.indexOf('type') !== -1)\n          throw new Error(\"'type' can't be used as a protvista attribute\")\n        if (this._attributes.indexOf('value') !== -1)\n          throw new Error(\"'value' can't be used as a protvista attribute\")\n      }\n    }\n  }\n\n  _setAttributes(elements, type, value) {\n    for (const el of elements) {\n      if (value === false) {\n        el.removeAttribute(type);\n      } else {\n        el.setAttribute(type, typeof (value) === 'boolean' ? '' : value);\n      }\n    }\n  }\n\n  _registerProtvistaDescendents(element) {\n    for (const child of element.children) {\n      if (child.isManaged)\n        this.protvistaElements.add(child);\n      this._registerProtvistaDescendents(child);\n    }\n  }\n\n  addListeners() {\n    for (const child of this.protvistaElements) {\n      child.addEventListener(\"change\", e => {\n        if (this._attributes.indexOf(e.detail.type) !== -1) {\n          this._setAttributes(this.protvistaElements, e.detail.type, e.detail.value);\n        }\n        for (let key in e.detail) {\n          if (this._attributes.indexOf(key) !== -1) {\n            this._setAttributes(this.protvistaElements, key, e.detail[key]);\n          }\n        }\n      });\n    }\n  }\n\n  connectedCallback() {\n    this._registerProtvistaDescendents(this);\n    this.addListeners();\n    var that = this;\n\n    if ('MutationObserver' in window) {\n      this.mutationObserver = new MutationObserver(mutationList => {\n        that._registerProtvistaDescendents(that);\n        that.addListeners();\n      });\n      this.mutationObserver.observe(this, {\n        childList: true\n      });\n    }\n  }\n\n  disconnectedCallback() {\n    if (this.mutationObserver) {\n      this.mutationObserver.disconnect();\n    }\n  }\n\n}\n\nexport default ProtVistaManager;","import ProtVistaManager from './protvista-manager';\n\nconst loadComponent = function() {\n  customElements.define('protvista-manager', ProtVistaManager);\n};\n\n// Conditional loading of polyfill\nif (window.customElements) {\n    loadComponent();\n} else {\n    document.addEventListener('WebComponentsReady', function() {\n        loadComponent();\n    });\n}\n\nexport default ProtVistaManager;\n"],"names":["ProtVistaManager","HTMLElement","constructor","protvistaElements","Set","observedAttributes","attributeChangedCallback","name","oldValue","newValue","_attributes","split","indexOf","Error","_setAttributes","elements","type","value","el","removeAttribute","setAttribute","_registerProtvistaDescendents","element","child","children","isManaged","add","addListeners","addEventListener","e","detail","key","connectedCallback","that","window","mutationObserver","MutationObserver","mutationList","observe","childList","disconnectedCallback","disconnect","loadComponent","customElements","define","document"],"mappings":"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"}